<%= render Panda::Core::Admin::ContainerComponent.new do |component| %>
  <% component.with_heading_slot(text: "Edit User: #{@user.name}", level: 1) %>

  <%= panda_form_with model: @user,
              url: admin_user_path(@user),
              method: :patch,
              local: true do |f| %>
    <%= render Panda::Core::Admin::FormErrorComponent.new(model: @user) %>

    <%= render Panda::Core::Admin::PanelComponent.new do |panel| %>
      <% panel.with_heading_slot { "User Settings" } %>
      <div class="space-y-4">
        <!-- User Info Display (Read-only) -->
        <div class="flex items-center gap-4 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg">
          <% url = @user.avatar_url(size: :medium) %>
          <% if url.present? %>
            <img src="<%= url %>" alt="<%= @user.name %>" class="h-16 w-16 rounded-full object-cover">
          <% else %>
            <div class="h-16 w-16 rounded-full bg-gray-200 dark:bg-gray-600 flex items-center justify-center">
              <i class="fa-solid fa-user text-xl text-gray-400 dark:text-gray-300"></i>
            </div>
          <% end %>
          <div>
            <p class="text-sm text-gray-500 dark:text-gray-400">Editing profile for</p>
            <p class="font-medium text-gray-900 dark:text-white"><%= @user.email %></p>
          </div>
        </div>

        <%= f.text_field :name %>
        <%= f.email_field :email %>
        <%= f.check_box :admin, {
          label: "Administrator",
          meta: @user == current_user ? "You cannot change your own admin status." : "Grant this user full administrative access.",
          disabled: (@user == current_user)
        } %>
      </div>
    <% end %>

    <%= render Panda::Core::Admin::FormFooterComponent.new(submit_text: "Update User") %>
  <% end %>
<% end %>
