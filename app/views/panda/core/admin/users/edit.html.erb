<%= render Panda::Core::Admin::ContainerComponent.new do |component| %>
  <% component.with_heading_slot(text: "Edit User: #{@user.name}", level: 1) %>

  <%= form_with model: @user,
              url: admin_user_path(@user),
              method: :patch,
              local: true do |f| %>
    <%= render Panda::Core::Admin::FormErrorComponent.new(model: @user) %>

    <div class="space-y-6 max-w-2xl">
      <!-- User Info Display (Read-only) -->
      <div class="flex items-center gap-4 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg">
        <% if @user.avatar.attached? %>
          <%= image_tag main_app.url_for(@user.avatar.variant(:medium)), alt: @user.name, class: "h-16 w-16 rounded-full object-cover" %>
        <% elsif @user.image_url.present? %>
          <img src="<%= @user.image_url %>" alt="<%= @user.name %>" class="h-16 w-16 rounded-full object-cover">
        <% else %>
          <div class="h-16 w-16 rounded-full bg-gray-200 dark:bg-gray-600 flex items-center justify-center">
            <i class="fa-solid fa-user text-xl text-gray-400 dark:text-gray-300"></i>
          </div>
        <% end %>
        <div>
          <p class="text-sm text-gray-500 dark:text-gray-400">Editing profile for</p>
          <p class="font-medium text-gray-900 dark:text-white"><%= @user.email %></p>
        </div>
      </div>

      <div class="field">
        <%= f.label :name %>
        <%= f.text_field :name, class: "mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm dark:bg-gray-700 dark:border-gray-600 dark:text-white" %>
      </div>

      <div class="field">
        <%= f.label :email %>
        <%= f.email_field :email, class: "mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm dark:bg-gray-700 dark:border-gray-600 dark:text-white" %>
      </div>

      <!-- Admin Toggle -->
      <div class="relative flex items-start">
        <div class="flex h-6 items-center">
          <%= f.check_box :admin,
              class: "h-4 w-4 rounded border-gray-300 text-primary-600 focus:ring-primary-600 dark:border-gray-600 dark:bg-gray-700",
              disabled: (@user == current_user) %>
        </div>
        <div class="ml-3">
          <%= f.label :admin, "Administrator", class: "text-sm font-medium text-gray-900 dark:text-white" %>
          <p class="text-sm text-gray-500 dark:text-gray-400">
            <% if @user == current_user %>
              You cannot change your own admin status.
            <% else %>
              Grant this user full administrative access.
            <% end %>
          </p>
        </div>
      </div>
    </div>

    <%= render Panda::Core::Admin::FormFooterComponent.new(
      submit_text: "Update User",
      cancel_path: admin_users_path
    ) %>
  <% end %>
<% end %>
